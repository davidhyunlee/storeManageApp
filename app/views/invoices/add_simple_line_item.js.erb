<% if @simple_item.nil? %>
	$("#error").modal('show');
<% elsif @simple_item.quantity <= 0 %>
	alert("This item is sold out. Must receive more to sell.")
<% elsif @quantity.to_i > @simple_item.quantity %>
	alert("You are trying to sell more than you have of this item.")
<% else %>
	$(".line_item_area").append("<%= j render partial: 'invoices/add_simple_line_item' %>");
	$(".add-area").empty();

	var subtotal = parseFloat($("#subtotal").text()) + <%= @simple_item.sellable.retail_price * @quantity.to_i %>
	
	<% if @simple_item.sellable.taxable %>
	var salestax = parseFloat($("#salestax").text()) + (<%= @simple_item.sellable.taxable_price * @quantity.to_i %> * <%= Setting.sales_tax.to_f %>)
	var total = parseFloat($("#total").text()) + <%= @simple_item.sellable.retail_price * @quantity.to_i %> + (<%= @simple_item.sellable.retail_price * @quantity.to_i %> * <%= Setting.sales_tax %>)
	<% end %>
	
	<% unless @simple_item.sellable.taxable %>
	var total = subtotal
	<% end %>

	$("#subtotal").text(subtotal.toFixed(2))
	<% if @simple_item.sellable.taxable %>
	$("#salestax").text(salestax.toFixed(2))
	<% end %>
	$("#total").text(total.toFixed(2))
	$("#hidden_subtotal").attr("value", $("#subtotal").text())
	<% if @simple_item.sellable.taxable %>
	$("#hidden_salestax").attr("value", $("#salestax").text())
	<% end %>
	$("#hidden_total").attr("value", $("#total").text())
<% end %>